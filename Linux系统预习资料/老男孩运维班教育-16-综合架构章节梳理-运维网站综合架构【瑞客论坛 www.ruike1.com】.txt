===========================================================================================
# 老男孩教育：                                                                            #
# www.oldboyedu.com                                                                       #
# 邮件：miaokm@oldboyedu.com(189 1048 1057)                                               #
# 地址：北京市昌平区顺沙路8号院汇德商厦4F                                                 #
# 资源老师   手机电话：		    QQ号码        资源老师： 手机电话：		    QQ号码        #
# 飞雪		 135 5261 2571		80042789      小雨		 186 0046 2391      390320151     #
# 歪歪		 189 1171 8229		70271111      丹丹		 158 1059 0206      41117397      #
# 冰冰		 150 1078 5220		41117483												  #
===========================================================================================

老男孩教育北京57期-day28-综合架构开场说明
==============================

00. 课程回顾说明
    1) 网络中的两个重要原理
	   DNS解析原理: 建立 域名   - IP地址  映射关系
	   ARP协议原理: 建立 IP地址 - mac地址 映射关系 (ARP表 mac表)
    
	2) IP地址的概念
	   IP地址的报文结构
	   IP地址的组成(网段地址+主机地址)
	   
	3) IP地址的类型
       IP地址的范围: A B C D E	
	   IP地址的用途: 私网地址(不同局域网中进行重复使用) 公网地址(全球唯一)
	                 什么NAT技术: 实现私网地址和公网地址映射 实现端口之间映射
	   IP地址的通讯方式: 单播地址 组播地址 广播地址
	   主机位全为0的, 称为网段地址
	   主机位全为1的, 称为广播地址
	   一个网段内有多少个主机=2的n次方 - 3
	   
	4) 虚拟主机上网原理 虚拟主机和xshell互连原理
       

01. 如何调整主机位数量(VLSM可变长子网掩码方式)
    为什么要调整主机位???
	对大的网络进行子网划分
	1. 容易造成地址浪费 
	2. 容易造成严重广播风暴问题
	3. 容易造成网络拥塞 路由器压力过大
	
	子网划分好处:
	1. 避免地址产生浪费(公网地址)
	2. 可以降低广播风暴问题
	3. 降低网络拥塞 减轻路由器压力

	如何子网划分: 将一个大的子网变为多个小的子网==较少主机位
	1) 子网较少主机位 将主机位变为网络位
	2) 调整划分的网络子网掩码
	3) 获得每个子网主机范围
	
	什么掩码(子网掩码)
	掩码也是有32位二进制数组成  每八位为一组  总共4组
	如何设置掩码: 掩码信息的设置需要参照IP地址信息
	
	IP  172.16.0.0  --  10101100.00010000. 00000000 00000000
    掩码                11111111.11111111. 00000000 00000000 == 255.255.0.0
    
    问题: 172.16.0.0/18  192.168.10.0/25
	1) 表示划分了几个子网
	2) 划分好的每个子网掩码信息
	3) 划分好的每个子网主机范围(最小值 - 最大值)

	   
02. VLAN概念(交换网络)
    LAN  --- 局域网接口 内网接口
	VLAN --- 虚拟局域网
	VLAN : 将交换机逻辑划分为多个虚拟局域网


03. 系统中如何添加路由信息
                       centos6                                   centos7
    静态默认路由    route add default gw 10.0.0.254              ip route add default via 10.0.0.254
	静态网段路由    route add -net  223.5.5.0/24 gw 10.0.0.254   ip route add 223.5.5.0/24 via 10.0.0.254
	静态主机路由    route add -host 223.5.5.5/32 gw 10.0.0.254   ip route add 223.5.5.5/32 via 10.0.0.254
    
	静态默认路由
	[root@oldboyedu-55 ~]# ip route add default via 10.0.0.254
    [root@oldboyedu-55 ~]# ip route show
    default via 10.0.0.254 dev ens33 
    10.0.0.0/24 dev ens33 proto kernel scope link src 10.0.0.200 
    169.254.0.0/16 dev ens33 scope link metric 1002 
    [root@oldboyedu-55 ~]# ping 223.5.5.5
    PING 223.5.5.5 (223.5.5.5) 56(84) bytes of data.
    64 bytes from 223.5.5.5: icmp_seq=1 ttl=128 time=43.2 ms
    64 bytes from 223.5.5.5: icmp_seq=2 ttl=128 time=43.8 ms
    ^C
    --- 223.5.5.5 ping statistics ---
    2 packets transmitted, 2 received, 0% packet loss, time 1002ms
    rtt min/avg/max/mdev = 43.205/43.512/43.820/0.371 ms

	静态网段路由 
	[root@oldboyedu-55 ~]# ip route add 223.5.5.0/24 via 10.0.0.254
    [root@oldboyedu-55 ~]# ip route show
    10.0.0.0/24 dev ens33 proto kernel scope link src 10.0.0.200 
    169.254.0.0/16 dev ens33 scope link metric 1002 
    223.5.5.0/24 via 10.0.0.254 dev ens33 
    [root@oldboyedu-55 ~]# ping 223.5.5.5
    PING 223.5.5.5 (223.5.5.5) 56(84) bytes of data.
    64 bytes from 223.5.5.5: icmp_seq=1 ttl=128 time=42.6 ms
    64 bytes from 223.5.5.5: icmp_seq=2 ttl=128 time=87.3 ms
    64 bytes from 223.5.5.5: icmp_seq=3 ttl=128 time=43.7 ms
	
	静态主机路由
	[root@oldboyedu-55 ~]# ip route add 223.5.5.5/32 via 10.0.0.254
    [root@oldboyedu-55 ~]# ip route show
    10.0.0.0/24 dev ens33 proto kernel scope link src 10.0.0.200 
    169.254.0.0/16 dev ens33 scope link metric 1002 
    223.5.5.5 via 10.0.0.254 dev ens33 
    [root@oldboyedu-55 ~]# ping 223.5.5.5
    PING 223.5.5.5 (223.5.5.5) 56(84) bytes of data.
    64 bytes from 223.5.5.5: icmp_seq=1 ttl=128 time=43.5 ms
    64 bytes from 223.5.5.5: icmp_seq=2 ttl=128 time=43.3 ms
    64 bytes from 223.5.5.5: icmp_seq=3 ttl=128 time=43.2 ms

04. 综合架构阶段
    1) 掌握各种服务 (存储 备份 网站 监控 自动化...)
	2) 完成一个中小企业网站搭建(考核--降级 59)
	3) 整体有大量增加
	
05. 综合架构组成(多台服务器)
    00 会员顾客 -- 网站访问者
	   作用: 访问网站
	01 安保人员 -- 防火墙(硬件:ASA 软件:firewalld/iptables)
	   作用: 控制管理用户访问的流量信息
    02 迎宾人员 -- 负载均衡
	   作用: 调度分配作用
	03 服务人员 -- 网站服务器web
       作用: 处理用户请求
	         能处理:   由服务员自己处理
			 不能处理: 交给后端人员处理
	04 厨师长   -- 数据库服务(存储数据 字符数据信息)
	   作用: 主要存储字符数据
	05 仓储人员 -- 存储服务器(存储数据 图片 附件 视频 音频)
	   作用: 存储图片附件等数据信息
    06 保管人员 -- 备份服务器(存储数据 备份存储)
       作用: 对数据进行恢复/对数据信息进行对比
	07 配菜人员 -- 缓存服务器(存储数据 内存存储) --- 数据库
	   作用: 读取效率更高 
	         存储数据存储服务器或数据服务器中已存在数据  --- 不怕丢失
			 热点数据放在缓存中存储                      --- 数据读取效率
    08 管理人员 -- 管理服务器(批量管理)  
       作用: 实现批量管理	


    综合架构服务器规划
	名称              hostname   IP地址                                                部署什么程序
	防火墙服务器      firewall   10.0.0.81/24(eth0-外网)  172.16.1.81/24(eth1-内网)    firewall
	负载均衡服务器    lb01       10.0.0.5/24(eth0-外网)   172.16.1.5/24(eth1-内网)     nginx      
	负载均衡服务器    lb02       10.0.0.6/24(eth0-外网)   172.16.1.6/24(eth1-内网)     nginx  
	网站服务器        web01      10.0.0.7/24(eth0-外网)   172.16.1.7/24(eth1-内网)     nginx 
	网站服务器        web02      10.0.0.8/24(eth0-外网)   172.16.1.8/24(eth1-内网)     nginx 
	网站服务器        web03      10.0.0.9/24(eth0-外网)   172.16.1.9/24(eth1-内网)     nginx 
	数据库服务器      db01       10.0.0.51/24(eth0-外网)  172.16.1.51/24(eth1-内网)    mysql
	存储服务器        nfs01      10.0.0.31/24(eth0-外网)  172.16.1.31/24(eth1-内网)    NFS    
	备份服务器        backup     10.0.0.41/24(eth0-外网)  172.16.1.41/24(eth1-内网)    rsync
	管理服务器        m01        10.0.0.61/24(eth0-外网)  172.16.1.61/24(eth1-内网)    ansible
	
预习作用:
01. 内部技术人员如何管理网站
02. 利用克隆方式部署多台主机
03. 模板机优化	
04. 了解backup服务器的部署与配置过程	
	
	
	


	   